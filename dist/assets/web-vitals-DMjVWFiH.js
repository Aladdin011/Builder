var q=Object.defineProperty;var O=(e,t,i)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var h=(e,t,i)=>O(e,typeof t!="symbol"?t+"":t,i);let H=-1;const v=e=>{addEventListener("pageshow",t=>{t.persisted&&(H=t.timeStamp,e(t))},!0)},l=(e,t,i,r)=>{let n,s;return o=>{t.value>=0&&(o||r)&&(s=t.value-(n??0),(s||n===void 0)&&(n=t.value,t.delta=s,t.rating=((a,c)=>a>c[1]?"poor":a>c[0]?"needs-improvement":"good")(t.value,i),e(t)))}},C=e=>{requestAnimationFrame(()=>requestAnimationFrame(()=>e()))},b=()=>{const e=performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},g=()=>{const e=b();return(e==null?void 0:e.activationStart)??0},u=(e,t=-1)=>{const i=b();let r="navigate";return H>=0?r="back-forward-cache":i&&(document.prerendering||g()>0?r="prerender":document.wasDiscarded?r="restore":i.type&&(r=i.type.replace(/_/g,"-"))),{name:e,value:t,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:r}},f=new WeakMap;function M(e,t){return f.get(e)||f.set(e,new t),f.get(e)}class R{constructor(){h(this,"t");h(this,"i",0);h(this,"o",[])}h(t){var n;if(t.hadRecentInput)return;const i=this.o[0],r=this.o.at(-1);this.i&&i&&r&&t.startTime-r.startTime<1e3&&t.startTime-i.startTime<5e3?(this.i+=t.value,this.o.push(t)):(this.i=t.value,this.o=[t]),(n=this.t)==null||n.call(this,t)}}const L=(e,t,i={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const r=new PerformanceObserver(n=>{Promise.resolve().then(()=>{t(n.getEntries())})});return r.observe({type:e,buffered:!0,...i}),r}}catch{}},S=e=>{let t=!1;return()=>{t||(e(),t=!0)}};let p=-1;const x=new Set,A=()=>document.visibilityState!=="hidden"||document.prerendering?1/0:0,T=e=>{if(document.visibilityState==="hidden"){if(e.type==="visibilitychange")for(const t of x)t();isFinite(p)||(p=e.type==="visibilitychange"?e.timeStamp:0,removeEventListener("prerenderingchange",T,!0))}},E=()=>{var e;if(p<0){const t=g();p=(document.prerendering||(e=globalThis.performance.getEntriesByType("visibility-state").filter(r=>r.name==="hidden"&&r.startTime>t)[0])==null?void 0:e.startTime)??A(),addEventListener("visibilitychange",T,!0),addEventListener("prerenderingchange",T,!0),v(()=>{setTimeout(()=>{p=A()})})}return{get firstHiddenTime(){return p},onHidden(t){x.add(t)}}},w=e=>{document.prerendering?addEventListener("prerenderingchange",()=>e(),!0):e()},F=[1800,3e3],$=(e,t={})=>{w(()=>{const i=E();let r,n=u("FCP");const s=L("paint",o=>{for(const a of o)a.name==="first-contentful-paint"&&(s.disconnect(),a.startTime<i.firstHiddenTime&&(n.value=Math.max(a.startTime-g(),0),n.entries.push(a),r(!0)))});s&&(r=l(e,n,F,t.reportAllChanges),v(o=>{n=u("FCP"),r=l(e,n,F,t.reportAllChanges),C(()=>{n.value=performance.now()-o.timeStamp,r(!0)})}))})},P=[.1,.25],W=(e,t={})=>{const i=E();$(S(()=>{let r,n=u("CLS",0);const s=M(t,R),o=c=>{for(const d of c)s.h(d);s.i>n.value&&(n.value=s.i,n.entries=s.o,r())},a=L("layout-shift",o);a&&(r=l(e,n,P,t.reportAllChanges),i.onHidden(()=>{o(a.takeRecords()),r(!0)}),v(()=>{s.i=0,n=u("CLS",0),r=l(e,n,P,t.reportAllChanges),C(()=>r())}),setTimeout(r))}))},D=e=>{const t=globalThis.requestIdleCallback||setTimeout;document.visibilityState==="hidden"?e():(e=S(e),addEventListener("visibilitychange",e,{once:!0,capture:!0}),t(()=>{e(),removeEventListener("visibilitychange",e,{capture:!0})}))};class I{constructor(){h(this,"m")}h(t){var i;(i=this.m)==null||i.call(this,t)}}const k=[2500,4e3],_=(e,t={})=>{w(()=>{const i=E();let r,n=u("LCP");const s=M(t,I),o=c=>{t.reportAllChanges||(c=c.slice(-1));for(const d of c)s.h(d),d.startTime<i.firstHiddenTime&&(n.value=Math.max(d.startTime-g(),0),n.entries=[d],r())},a=L("largest-contentful-paint",o);if(a){r=l(e,n,k,t.reportAllChanges);const c=S(()=>{o(a.takeRecords()),a.disconnect(),r(!0)}),d=m=>{m.isTrusted&&(D(c),removeEventListener(m.type,d,{capture:!0}))};for(const m of["keydown","click","visibilitychange"])addEventListener(m,d,{capture:!0});v(m=>{n=u("LCP"),r=l(e,n,k,t.reportAllChanges),C(()=>{n.value=performance.now()-m.timeStamp,r(!0)})})}})},B=[800,1800],y=e=>{document.prerendering?w(()=>y(e)):document.readyState!=="complete"?addEventListener("load",()=>y(e),!0):setTimeout(e)},j=(e,t={})=>{let i=u("TTFB"),r=l(e,i,B,t.reportAllChanges);y(()=>{const n=b();n&&(i.value=Math.max(n.responseStart-g(),0),i.entries=[n],r(!0),v(()=>{i=u("TTFB",0),r=l(e,i,B,t.reportAllChanges),r(!0)}))})};export{P as CLSThresholds,F as FCPThresholds,k as LCPThresholds,B as TTFBThresholds,W as onCLS,$ as onFCP,_ as onLCP,j as onTTFB};
